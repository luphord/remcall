<!DOCTYPE HTML>
<html>
<head>
    <title>remcall</title>
    <link rel="stylesheet" href="picnic.min.css">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            max-width: 1200px;
            margin: auto;
            margin-top: 50px;
        }
        .anchor {
            padding-top: 50px;
            margin-top: -50px;
        }
    </style>
</head>
<body>

<div>
<nav class="demo">
  <a href="#" class="brand">
    <img class="logo" src="favicon.png" />
    <span>remcall</span>
  </a>

  <!-- responsive-->
  <input id="bmenub" type="checkbox" class="show">
  <label for="bmenub" class="burger pseudo button">&#8801;</label>

  <div class="menu">
    <a href="#overview" class="pseudo button">Overview</a>
    <a href="#binary" class="pseudo button">Binary Representations</a>
    <a href="#schema" class="pseudo button">Schema Definition</a>
    <a href="#communication" class="pseudo button">Communication Protocol</a>
    <a href="#implementation" class="pseudo button">Implementation Guidelines</a>
    <a href="#examples" class="pseudo button">Examples</a>
  </div>
</nav>
</div>

<h1>Remcall - Remote Method Calls</h1>

<div class="anchor" id="overview"></div>

<h2>Overview</h2>

<p>Remcall (short for remote method calls) is a protocol for inter process communication (IPC) between different programming languages using object proxying as its primary method for information exchange.
Communication using remcall requires the upfront definition of a schema (comprised of record and enum types and more importantly interfaces with method signatures) which then depending on the programming language is compiled or interpreted.
Both communication participants are then free to implement any or none of the interfaces and reference concrete objects to the other side which will be represented using proxy objects.
There is a certain distinction between a server (waiting for connections, serving and entry point) and a client (initiating a connection, performing the first method call) in remcall, but the protocol allows for method calls and object proxying in both directions.
Remcall employs a <a href="#binary">binary representation</a> for both, its <a href="#schema">schema</a> and its <a href="#communication">communication protocol</a>. Communcation can be layered on top of any bidirectional streams supporting binary data such as TCP sockets, stdin/out, websockets.</p>

<div class="anchor" id="binary"></div>

<h2>Binary Representations</h2>

<p>Both schemas and communications are based on binary representations in remcall. The following rules apply to these representations:</p>

<ul>
<li>Primitive types in remcall are: <code>void</code>, <code>boolean</code>, <code>int8</code>, <code>uint8</code>, <code>int16</code>, <code>uint16</code>, <code>int32</code>, <code>uint32</code>, <code>int64</code>, <code>uint64</code>, <code>float32</code>, <code>float64</code>, <code>string</code>, <code>date</code>, <code>time</code>, <code>datetime</code></li>
<li>Bytes are represented using <code>uint8</code></li>
<li>Arrays of values are represented using a <code>uint32</code> denoting the length and then all consecutive binary representations of the values</li>
<li><code>string</code> values are encoded in UTF8 and then serialized as a byte-Array</li>
<li>Types are referenced using <code>int32</code>; negative values reference an array of the type that is referenced using the positive number</li>
<li>Methods are referenced using one of the unsigned integer types, the schema specifies which one to use</li>
<li>Objects are referenced using one of the signed integer types, the schema specifies which one to use; negative values indicate that the implementation resides on the client (and is proxied on the server), positive values indicate that the implementation resides on the server (and is proxied on the client)</li>
<li>The pseudo-type <code>name</code> is used in this document (but does not actually exist in remcall); it denotes a <code>string</code> that contains only characters from 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789' and does not start with a number; such names should usable as variable or type names in all modern programming languages</li>
<li>Binary values will usually be displayed using their hexadecimal representation in this document which will be indicated using a leading "0x", e.g. 0xff to display a <code>uint8</code> with value 255; longer sequences of binary data will be split into blocks of 4 bytes = 8 hex characters, e.g. 0x00000001 0x00000002 0x00000003;if binary values exhibit a useful string representation that will be used instead of hexadecimal values</li>
</ul>

<div class="anchor" id="schema"></div>

<h2>Schema Definition</h2>

<p>Schemas in remcall exhibit a canonical binary representation. This feature allows to identify schemas uniquely using a cryptographic hash (sha256) of that representation.
Upon initiating a remcall communication this hash value is exchanged between the two parties to ensure that the same schema is employed on both sides.</p>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Title</th>
      <th>Description</th>
      <th>Example / Constant Value<th>
    <tr>
  </thead>
  <tbody>
    <tr>
      <td><code>byte[7]</code></td>
      <td>Magic constant</td>
      <td>Marking the following stream of data as remcall related</td>
      <td>REMCALL</td>
    </tr>
    <tr>
      <td><code>byte[6]</code></td>
      <td>Magic schema constant</td>
      <td>Marking the following stream of data as a remcall schema (as opposed to a remcall communication)</td>
      <td>SCHEMA</td>
    </tr>
    <tr>
      <td><code>string</code></td>
      <td>Schema label</td>
      <td>Free text label for the schema; for informational purposes only, not reflected in the compiled code</td>
      <td>A nice schema</td>
    </tr>
    <tr>
      <div class="anchor" id="bytes-method-ref"></div>
      <td><code>uint32</code></td>
      <td>Number of bytes for method references</td>
      <td>During communication, methods are identified using unsigned integers of this length, allowed values are 1, 2, 4 and 8; should be checked against the number of available methods in the schema by the compiler</td>
      <td>0x00000002</td>
    </tr>
    <tr>
      <td><code>uint32</code></td>
      <td>Number of bytes for object references</td>
      <td>During communication, methods are identified using signed integers of this length, allowed values are 1, 2, 4 and 8; note that this number is a runtime restriction on the number of objects, using 1 restricts the number of possible object references to 128 on both client and server</td>
      <td>0x00000004</td>
    </tr>
    <tr>
      <td><code>uint32</code></td>
      <td>Number of enums</td>
      <td>Number of enum declarations to be read in the following</td>
      <td>0x00000002</td>
    </tr>
    <tr>
      <td><code>uint32</code></td>
      <td>Number of records</td>
      <td>Number of record declarations to be read in the following</td>
      <td>0x00000001</td>
    </tr>
    <tr>
      <td><code>uint32</code></td>
      <td>Number of interfaces</td>
      <td>Number of interface declarations to be read in the following</td>
      <td>0x00000001</td>
    </tr>
    <tr>
      <td>...</td>
      <td><a href="#enums">Enum declarations</a></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td>...</td>
      <td><a href="#records">Record declarations</a></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td>...</td>
      <td><a href="#interfaces">Interface declarations</a></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td><code>byte[32]</code></td>
      <td>sha256 hash of schema</td>
      <td>sha256 hash of schema</td>
      <td>0xf3b73b5a 0x9f6294c4 0xa8b6b6f1 0x3b9dd129 0x9e5e9152 0xcf256a31 0xe3d13867 0x7a0fcb61</td>
    </tr>
  </tbody>
</table>

<div class="anchor" id="enums"></div>

<h3>Declaration of Enums</h3>

<p>The following table defines the declaration of enums in remcall. The example values correspond to an enum called <code>Status</code> with possible values <code>ON</code> and <code>OFF</code>.</p>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Title</th>
      <th>Description</th>
      <th>Example / Constant Value<th>
    <tr>
  </thead>
  <tbody>
    <tr>
      <td><code>uint8</code></td>
      <td>Declare enum constant</td>
      <td>Marking the following stream of data as an enum declaration</td>
      <td>0x02</td>
    </tr>
    <tr>
      <td><code>int32</code></td>
      <td>Type reference for this enum</td>
      <td>ID by which this enum type can be referenced in the schema</td>
      <td>0x00000021</td>
    </tr>
    <tr>
      <td><code>name</code></td>
      <td>Name for this enum</td>
      <td>Type name for this enum used in target languages</td>
      <td>Status</td>
    </tr>
    <tr>
      <td><code>uint32</code></td>
      <td>Number of possible enum values</td>
      <td>Number of possible values this enum can take</td>
      <td>0x00000003</td>
    </tr>
    <tr>
      <td><code>name[]</code></td>
      <td>Possible values for this enum</td>
      <td>Sequence of <code>name</code> payloads that will be possible values for this enum</td>
      <td>0x00000002 0x00000002 ON 0x00000003 OFF</td>
    </tr>
  </tbody>
</table>

<div class="anchor" id="records"></div>

<h3>Declaration of Records</h3>

<p>The following table defines the declaration of records in remcall.</p>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Title</th>
      <th>Description</th>
      <th>Example / Constant Value<th>
    <tr>
  </thead>
  <tbody>
    <tr>
      <td><code>uint8</code></td>
      <td>Declare record constant</td>
      <td>Marking the following stream of data as a record declaration</td>
      <td>0x03</td>
    </tr>
    <tr>
      <td><code>int32</code></td>
      <td>Type reference for this record</td>
      <td>ID by which this record type can be referenced in the schema</td>
      <td>0x00000022</td>
    </tr>
    <tr>
      <td><code>name</code></td>
      <td>Name for this record</td>
      <td>Type name for this record used in target languages</td>
      <td>Address</td>
    </tr>
    <tr>
      <td><code>uint32</code></td>
      <td>Number of record fields</td>
      <td>Number of fields this record type contains</td>
      <td>0x00000002</td>
    </tr>
    <tr>
      <td>...</td>
      <td><a href="#record-fields">Field declarations</a></td>
      <td>Sequence (of length as defined by previous <code>uint32</code>) of type-name pairs describing individual record fields</td>
      <td></td>
    </tr>
  </tbody>
</table>

<div class="anchor" id="record-fields"></div>

<p>The following table describes the field declarations within a record.  This declaration works exactly the same way as <a href="#method-args">method argument declarations</a>.</p>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Title</th>
      <th>Description</th>
      <th>Example / Constant Value<th>
    <tr>
  </thead>
  <tbody>
    <tr>
      <td><code>int32</code></td>
      <td>Type reference for this field</td>
      <td>References a type (primitive or complex)</td>
      <td>0x0000000C</td>
    </tr>
    <tr>
      <td><code>name</code></td>
      <td>Name for this field</td>
      <td>Field name used in target languages</td>
      <td>Street</td>
    </tr>
  </tbody>
</table>

<div class="anchor" id="interfaces"></div>

<h3>Declaration of Interfaces</h3>

<p>The following table defines the declaration of interfaces in remcall.</p>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Title</th>
      <th>Description</th>
      <th>Example / Constant Value<th>
    <tr>
  </thead>
  <tbody>
    <tr>
      <td><code>uint8</code></td>
      <td>Declare interface constant</td>
      <td>Marking the following stream of data as an interface declaration</td>
      <td>0x04</td>
    </tr>
    <tr>
      <td><code>int32</code></td>
      <td>Type reference for this interface</td>
      <td>ID by which this interface type can be referenced in the schema</td>
      <td>0x00000023</td>
    </tr>
    <tr>
      <td><code>name</code></td>
      <td>Name for this interface</td>
      <td>Type name for this interface used in target languages</td>
      <td>User</td>
    </tr>
    <tr>
      <td><code>uint32</code></td>
      <td>Number of methods</td>
      <td>Number of methods this interface type contains</td>
      <td>0x00000005</td>
    </tr>
    <tr>
      <td>...</td>
      <td><a href="#methods">Method declarations</a></td>
      <td>Sequence (of length as defined by previous <code>uint32</code>) of method declarations</td>
      <td></td>
    </tr>
  </tbody>
</table>

<div class="anchor" id="methods"></div>

<p>The following table describes the method declarations within an interface.</p>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Title</th>
      <th>Description</th>
      <th>Example / Constant Value<th>
    <tr>
  </thead>
  <tbody>
    <tr>
      <td><code>uint8</code>, <code>uint16</code>, <code>uint32</code> or <code>uint64</code></td>
      <td>Method reference</td>
      <td>Reference to this method; exact type is defined in schema header by <a href="#bytes-method-ref">Number of bytes for method references</a></td>
      <td>0x09</td>
    </tr>
    <tr>
      <td><code>name</code></td>
      <td>Name for this method</td>
      <td>Method name used in target languages</td>
      <td>SetName</td>
    </tr>
    <tr>
      <td><code>uint32</code></td>
      <td>Number of arguments</td>
      <td>Number of arguments this method expects</td>
      <td>0x00000001</td>
    </tr>
    <tr>
      <td>...</td>
      <td><a href="#method-args">Method arguments</a></td>
      <td>Sequence (of length as defined by previous <code>uint32</code>) of type-name pairs describing individual arguments</td>
      <td></td>
    </tr>
  </tbody>
</table>

<div class="anchor" id="method-args"></div>

<p>The following table describes the argument declarations within a method. This declaration works exactly the same way as <a href="#record-fields">record field declarations</a>.</p>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Title</th>
      <th>Description</th>
      <th>Example / Constant Value<th>
    <tr>
  </thead>
  <tbody>
    <tr>
      <td><code>int32</code></td>
      <td>Type reference for this argument</td>
      <td>References a type (primitive or complex)</td>
      <td>0x0000000C</td>
    </tr>
    <tr>
      <td><code>name</code></td>
      <td>Name for this argument</td>
      <td>Argument name used in target languages</td>
      <td>name</td>
    </tr>
  </tbody>
</table>

<div class="anchor" id="communication"></div>

<h2>Communication Protocol</h2>

<div class="anchor" id="implementation"></div>

<h2>Implementation Guidelines</h2>

<div class="anchor" id="examples"></div>

<h2>Examples</h2>

<p>lots</p>

<p>of</p>

<p>empty</p>

<p>pargagraphs</p>

<p>lots</p>

<p>of</p>

<p>empty</p>

<p>pargagraphs</p>

<p>lots</p>

<p>of</p>

<p>empty</p>

<p>pargagraphs</p>

<p>lots</p>

<p>of</p>

<p>empty</p>

<p>pargagraphs</p>

<p>lots</p>

<p>of</p>

<p>empty</p>

<p>pargagraphs</p>


</body>
</html>

